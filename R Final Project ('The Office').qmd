---
title: "R Final Project ('The Office')"
author: "McKenzie Price"
format: html

---
```{r}
library(schrute)
library(tidyverse)
library(here)

office_ratings <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-17/office_ratings.csv')

# save the complete-case data
saveRDS(office_ratings, here::here("office_data.rds"))

office_data <- readRDS(here::here("office_data.rds"))
```

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## Running Code
When you click the **Render** button a document will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
library(gtsummary)
tbl_summary(
	office_data,
	by = season,
	include = c(imdb_rating, total_votes, air_date),
  label = list(
  	imdb_rating ~ "IMDB Rating",
  	total_votes ~ "Total Votes",
  	air_date ~ "Air Date"),

	statistic = list(
		imdb_rating ~ "{mean} ({min}, {max})",
		total_votes ~ "{sum}",
		air_date ~ "({min}) to ({max})"),

missing_text = "Missing"
) |>
	modify_caption("**Summary of 'The Office' Episodes by Season**")
```

You can add options to executable code like this 

```{r}
poisson_model <- glm(total_votes ~ imdb_rating + season,
										 family = poisson,
										 data = office_data)
tbl_regression(
	poisson_model,
	exponentiate = TRUE,
	label = list(
		imdb_rating ~ "IMDB Rating",
		season ~ "Season"
	)) |>
	modify_caption("**Poisson Regression Analysis**")
```

```{r}
boxplot(imdb_rating ~ season, data = office_data,
				main = "Box Plot Comparing 'The Office' IMDB Ratings by Season",
				xlab = "Season",
				ylab = "IMDB Rating",
				outline = TRUE)
```


The `echo: false` option disables the printing of code (only output is displayed).
